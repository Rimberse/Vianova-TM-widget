<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:widget="http://www.netvibes.com/ns/">

<head>
    <title>Vianova T&M widget</title>
    <meta name="author" content="Kerim HUDAYBERDIYEV" />
    <meta name="description" content="Widget used to feed Vianova t&m data into City" />
    <meta name="keywords" content="Transportation, mobility, connected vehicles data" />
    <meta name="apiVersion" content="0.1" />
    <meta name="debugMode" content="true" />
    <meta name="strictMode" content="false" />

    <!-- FOR DEV PURPOSE ONLY -->
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <!-- End of FOR DEV PURPOSE ONLY -->

    <!-- Application Standalone emulation files -->
    <link rel="stylesheet" type="text/css" href="http://uwa.netvibes.com/lib/c/UWA/assets/css/standalone.css" />
    <script type="text/javascript" src="http://uwa.netvibes.com/lib/c/UWA/js/UWA_Standalone_Alone.js"></script>

    <!-- Custom CSS or JS library -->
    <link rel="stylesheet" type="text/css" href="styles/style.css" />
    <!-- <script type="text/javascript" src="http://uwa.netvibes.com/lib/c/UWA/js/UWA_Standalone_Alone.js"></script> -->

    <script>
        // (async () => {
        //     let host = 'https://vianova-tm.herokuapp.com/api';
        //     let path = '/token'
        //     const address = host.concat(path);

        //     let rawResponse = await fetch(address, { method: 'GET' });
        //     let data = await rawResponse.json();
        //     console.log(data['access_token']);

        //     path = '/zoneID?token=';

        //         // const headers = new Headers({ 'Authorization': 'Bearer ' + data['access_token'] });

        //         // const requestOptions = {
        //         //     method: 'GET'
        //         //     // headers,
        //         //     // redirect: 'follow'
        //         // };

        //         // fetch(host.concat(path) + data['access_token'])
        //         //     .then(response => response.json())
        //         //     .then(result => console.log(result.zone_id))
        //         //     .catch(error => console.log('error', error));

        //         rawResponse = await fetch(host.concat(path) + data['access_token'], { method: 'GET' })
        //         data = await rawResponse.json();
        //         console.info("INDEX: " + data['zone_id']);
        // })();

        var host = 'https://rimberse.github.io',       // URL of server
            project = '/Vianova-TM-widget';            // folder referencing to your project resources

        // AMD loader setting. For complete documentation, refer to https://requirejs.org/docs/whyamd.html
        require.config({
            paths: {
                'Widget': host + project,
                'Modules': host + project + '/modules'
            }
        });

        require(
            [
                "Widget/js/Main"
            ],
            function (
                Main
            ) {
                // global variables (widget, UWA, document)

                // Function to call when widget is loaded
                widget.addEvent("onLoad", Main.onLoad);

                // Function to call when widget is being resized
                widget.addEvent("onResize", Main.onResize);

                // Function to call when widget view changed
                widget.addEvent("onViewChange", Main.onViewChange);

                // Function to call when a preference item is changed
                widget.addEvent("onEdit", Main.onEdit);

                // Function to call when refresh button is clicked
                widget.addEvent("onRefresh", Main.onRefresh);

                // Function to call when prefence edit is finalized
                widget.addEvent("endEdit", Main.endEdit);
            }
        );
    </script>
</head>

<body>

</body>

</html>